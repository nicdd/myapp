<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/ud-stepper/ud-stepper.html">
<link rel="import" href="../../bower_components/ud-stepper/ud-step.html">
<link rel="import" href="../administrator/general-column-configuration.html">
<link rel="import" href="../administrator/import-paechter.html">

<dom-module id="my-paechter-imports">
  <template>
    <style>
      :host {
        display: block;

        padding: 10px 20px;
      }
    </style>
    
    <ud-stepper id="stepper" vertical linear>
        <ud-step title="Allgemeine Spaltenkonfiguration" completed="[[stepsCompletion.gencols]]" editable hide-actions>
          <div >
            <general-column-configuration completed="{{stepsCompletion.gencols}}"></general-column-configuration>
          </div>
        </ud-step>
        <ud-step title="PÃ¤chter importieren" completed="[[stepsCompletion.importing]]" editable="[[stepsCompletion.gencols]]" 
        optional="[[stepsCompletion.gencols]]" optional-text="" hide-actions>
          <div >
            <import-paechter></import-paechter>
          </div>
        </ud-step>
        
    </ud-stepper>
    
  </template>

  <script>
    class MyPaechterImports extends Polymer.Element {
      static get is() { return 'my-paechter-imports'; }
      static get properties() {
        return {
         stepsCompletion:{
           type: Object,
           value:{
             gencols: false,
             importing: false
           },
           notify: true
         }
        };
      }

      static get observers() {
        return [
          'onStepsCompletionChanged(stepsCompletion.*)'
        ];
      }

      onStepsCompletionChanged(){
        console.log('onStepsCompletionChanged')
        let firstNotCompleted = null;
        Object.keys(this.stepsCompletion).forEach((step, index)=>{
          if (!this.stepsCompletion[step] && (null === firstNotCompleted)){
            firstNotCompleted = index;
          }
        })
        console.log('onStepsCompletionChanged firstNotCompleted' + firstNotCompleted)
        if (firstNotCompleted || firstNotCompleted === 0){
          this.$.stepper.selected = firstNotCompleted;
        }
        this.$.stepper.notifyPath('_steps');
      }

      getstepcompletion(){
        return JSON.stringify(this.stepsCompletion)
      }
    }

    window.customElements.define(MyPaechterImports.is, MyPaechterImports);
  </script>
</dom-module>
