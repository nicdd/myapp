<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/paper-progress-button/paper-progress-button.html">


<link rel="import" href="../bower_components/vaadin-grid/theme/material/all-imports.html">
<link rel="import" href="clients/firstclient.html">
<link rel="import" href="shared-styles.html">


<dom-module id="my-view3">
  <template>
    <style include="shared-styles">
      :host {
        display: block;

        padding: 10px;
      }

      .demo {
        --paper-progress-active-color: #1875d1;
        --paper-progress-container-color: #00000000;

        --paper-button-mixin: {
          background-color: #1976d2;
          color: white;
        }

        --paper-button-disabled-mixin: {
          background: #efefef;
          color: black;
        }

        .vaadin-demo-input[readonly] {
          border: 2px solid transparent;
          pointer-events: none;
        }
         input[vaadin-demo-input]{
          max-width: 10px !important;
        } 
        /* .vaadin-demo-input {
           font: inherit;
          width: 100%; 
          max-width: 50%;
        } */

      }
    </style>

    <first-client id="firstclient"></first-client>
    <div class="card">
      <div class="circle">3</div>
      <h1>View Three</h1>
      <div>
        <!-- <table class="centered-table">
        
          <template is="dom-repeat" items="{{_katzen}}" index-as="i">
            <tr>
              <td><label for="cat[[i]]">Name:</label></td>
              <td><input id="cat[[i]]" value="{{item.name::change}}" /></td>
            </tr>
          </template>
      </table> -->
        <vaadin-checkbox checked="{{editing}}" style="margin-bottom: 20px">Enable Editing</vaadin-checkbox>
        <vaadin-grid aria-label="Basic Binding Example" items="[[mdata]]">
          <vaadin-grid-column width="20px" flex-grow="0">
            <template class="header">#</template>
            <template>[[index]]</template>
            <!-- If necessary, the footer could be set using <template class="footer"> -->
            <template class="footer">#</template>
          </vaadin-grid-column>

          <vaadin-grid-column>

            <template class="header">First Name</template>
            <template>
              <input class="vaadin-demo-input" value="{{item.firstName::input}}" readonly$="[[!editing]]" >
            </template>
            <template class="footer">First Name</template>
          </vaadin-grid-column>

          <vaadin-grid-column>
            <template class="header">Last Name</template>
            <template> <input class="vaadin-demo-input" value="{{item.lastName::input}}" readonly$="[[!editing]]" style="max-width: -moz-available;"></template>
            <template class="footer">Last Name</template>
          </vaadin-grid-column>

          <vaadin-grid-column width="200px">
            <template class="header">Email</template>
            <template>[[item.firstName]].[[item.lastName]]@example.com</template>
          </vaadin-grid-column>

          <vaadin-grid-column width="8em">
            <template class="header">Address</template>
            <template>
              <div style="white-space: normal">[[item.address.street]], [[item.address.city]]</div>
            </template>
            <template class="footer">Address</template>
          </vaadin-grid-column>
        </vaadin-grid>

        <paper-progress-button class="demo" bottom raised on-click="postCats" loading-label="Nicht so hecktisch ..."
          loading="[[_loading]]">Speichern</paper-progress-button>
      </div>

  </template>





  <script>
    class MyView3 extends Polymer.Element {
      static get is() { return 'my-view3'; }

      static get properties() {
        return {
          _katzen: {
            type: Array,
            value: null,
            notify: true
          },
          _loading: {
            type: Boolean,
            value: false
          },
          mdata: {
            type: Array,
            value: [{
              firstName: "addd",
              lastName: "aaaa",
              address: {
                street: "stra",
                city: "citya"
              }
            }, {
              firstName: "bddd",
              lastName: "bbbb",
              address: {
                street: "strb",
                city: "cityb"
              }
            }, {
              firstName: "cddd",
              lastName: "cccc",
              address: {
                street: "strc",
                city: "cityc"
              }
            }]
          }
        }
      }

      ready() {
        super.ready();
        this.$.firstclient.getCats().then((resp) => {
          console.log("die antwort kam:" + JSON.stringify(resp))
          this._katzen = resp.cats;
          //this.mdata = JSON.stringify(resp.cats)
        })
      }

      postCats() {
        console.log('data ist' + JSON.stringify(this.$.ggg.data))
        let self = this;
        self._setLoading(true)
        console.log('speichern gedrÃ¼ckt');
        self.$.firstclient.postCats(JSON.stringify({ cats: self._katzen })).finally(() => {
          console.log('finally erreicht')
          setTimeout(function () {
            self._setLoading(false)
          }, 1000);
        })
      }

      _setLoading(val) {
        this.set('_loading', val);
      }
    }

    window.customElements.define(MyView3.is, MyView3);
  </script>
</dom-module>